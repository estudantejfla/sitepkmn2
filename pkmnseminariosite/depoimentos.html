<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <title>Depoimentos - Criar Time Pokémon</title>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css">

</head>
<body>
  
  <video autoplay muted loop id="bg-video" class="background-video">
    <source src="imagens/background.mp4" type="video/mp4">
  </video>

  <div class="container">
    
  <div class="navbar">
    <a href="index.html">Início</a>
    <a href="blog.html">Blog</a>
    <a href="postar.html">Nova Postagem</a>
    <a href="times.html">Meus Times</a>
    <a href="criar_time.html">Criar Time</a>
    <a href="publicos.html">Times Públicos</a>
    <a href="cadastro.html">Tipos</a>
    <a href="faq.html">FAQ</a>
    <a href="depoimentos.html">Depoimentos</a>
    <a href="sobre.html">Sobre</a>
  </div>

    
  <h1>Depoimentos</h1>
  <div class="grid three">
    <div class="card"><p>"Essa parte existe so para completar dez paginas?"</p><span class="muted">Ninguem</span></div>
    <div class="card"><p>"Talvez"</p><span class="muted">Dor</span></div>
    <div class="card"><p>"Fiquei sem ideias"</p><span class="muted">aaaaaa</span></div>
  </div>
  <h2>Deixe seu comentário</h2>
<input id="depNome" class="input" placeholder="Seu nome...">
<textarea id="depInput" class="input" placeholder="Escreva aqui..."></textarea>
<button class="btn" id="depBtn">Enviar</button>
<div id="depList" class="stack"></div>

<script src="frontend-api.js"></script>
<script>
(async function(){
  const user = JSON.parse(localStorage.getItem("user")||"null");

  async function load() {
    const res = await apiFetch("/depoimentos");
    const items = res.ok ? (res.data || []) : [];
    const list = document.getElementById('depList');
    list.innerHTML = items.map(t=>`<div class='card'><p>"${t.message}"</p><span class="muted">${t.user?.username||t.userId}</span></div>`).join('');
  }

  document.getElementById('depBtn').addEventListener('click', async ()=>{
    const v = document.getElementById('depInput').value.trim();
    const n = document.getElementById('depNome').value.trim() || (user?.username || "Anônimo");
    if(!v) return;
    const payload = user ? { userId: user.id, message: v } : { userId: null, message: v };
    const res = await apiFetch("/depoimentos", { method: "POST", body: JSON.stringify(payload) });
    if (res.ok) {
      document.getElementById('depInput').value = '';
      document.getElementById('depNome').value = '';
      load();
    } else alert(res.data?.error || 'Erro ao enviar depoimento');
  });

  load();
})();
</script>


  </script>

  </div>
  <script src="script.js"></script>
</body>
</html>
